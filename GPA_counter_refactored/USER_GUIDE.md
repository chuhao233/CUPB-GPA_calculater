# CUPB绩点计算器 - 用户指南

## 简介

CUPB绩点计算器是专为中国石油大学（北京）学生设计的GPA计算工具。它可以帮助您快速计算平均学分绩、课程绩点和平均学分绩点（GPA）。本应用专为Windows平台设计。

## 安装

### 方式一：使用可执行文件（推荐）

1. 从发布页面下载最新版本的`CUPB_GPA_Calculator.exe`
2. 双击运行即可，无需安装Python或任何依赖

### 方式二：从源代码运行（适合开发者）

如果您熟悉Python，也可以从源代码运行：

1. 确保您的系统安装了Python 3.6或更高版本
2. 安装依赖包：
   ```
   pip install pandas numpy pyqt5
   ```
3. 从项目根目录运行：
   ```
   python run.py
   ```
   或者使用提供的批处理文件：
   ```
   start.bat
   ```

## 使用方法

### 第1步：准备Excel文件

首先，您需要准备一个包含课程信息的Excel文件。文件应包含以下列：
- 课程名称
- 课程成绩（支持百分制或五等级制：优秀、良好、中等、及格、不及格）
- 课程学分

您可以参考程序附带的`Excel表格示例.xlsx`文件。

### 第2步：启动程序

双击运行`CUPB_GPA_Calculator.exe`（或者如果是从源代码运行，执行`python run.py`或`start.bat`）。

### 第3步：导入数据

1. 在"导入数据"选项卡中，点击"浏览..."按钮
2. 选择您准备好的Excel文件
3. 程序将自动加载课程数据并显示在表格中
4. 检查数据是否正确

### 第4步：计算绩点

1. 点击"计算绩点"按钮
2. 程序会自动切换到"计算结果"选项卡，显示计算结果
3. 您可以看到：
   - 平均学分绩
   - 各课程绩点
   - 平均学分绩点（GPA）

### 第5步：保存结果（可选）

1. 如果您想保存此次计算结果，点击"保存结果"按钮
2. 结果将被保存到历史记录中，您可以在"历史记录"选项卡查看

### 第6步：查看历史记录（可选）

1. 切换到"历史记录"选项卡
2. 您可以看到所有之前保存的计算结果
3. 双击任何一条记录可以查看详细信息
4. 您也可以删除不需要的记录或清空所有历史记录

## 命令行参数

如果您是从源代码运行，可以使用以下命令行参数：

```
# 使用命令行界面
python run.py --console

# 使用图形界面
python run.py --gui

# 启用调试模式
python run.py --debug

# 直接指定Excel文件路径
python run.py --file "path/to/excel.xlsx"
```

## 常见问题

### 问题：程序无法启动

**解决方案**：
- 确保您的Windows系统是最新的
- 尝试以管理员身份运行程序
- 如果您是从源代码运行，确保已安装所有必要的依赖

### 问题：Excel文件无法导入

**解决方案**：
- 确保Excel文件格式正确（参考`Excel表格示例.xlsx`）
- 检查文件是否被其他程序占用
- 尝试将文件另存为较新版本的Excel格式（如.xlsx）

### 问题：计算结果与预期不符

**解决方案**：
- 检查Excel中的成绩和学分数据是否正确
- 确认五等级制成绩（优秀、良好等）的输入是否正确
- 查看日志文件（位于`logs`目录）获取更多信息

### 问题：历史记录无法保存或丢失

**解决方案**：
- 历史记录默认保存在程序目录下的`data/history.json`文件中
- 如果程序没有权限在其目录创建文件，历史记录将保存在临时目录
- 尝试以管理员身份运行程序
- 定期备份历史记录文件以防数据丢失

## 系统要求

- 操作系统: Windows 7/8/10/11
- 如果从源码运行: Python 3.6+

## 隐私声明

本程序不会收集或上传任何个人数据。所有计算和数据存储都在本地完成，不会发送到任何服务器。 
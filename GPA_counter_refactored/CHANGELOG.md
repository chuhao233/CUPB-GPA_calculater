# 更新日志

## V3.0-Windows By chuhao233 (2025-05-30)

### 主要更新

1. **完全重构代码架构**
   - 采用模块化设计，将代码分为UI、计算器、数据加载等多个模块
   - 使用面向对象编程，提高代码可维护性和可扩展性
   - 添加了完整的类型注解，提高代码可读性

2. **增强Windows平台支持**
   - 修复了中文显示乱码问题
   - 优化了Windows下的文件路径处理
   - 移除了不必要的Linux/MacOS相关文件，专注于Windows平台

3. **改进用户界面**
   - 重新设计了图形用户界面，更加现代化和用户友好
   - 添加了历史记录功能，可以保存和查看过去的计算结果
   - 支持导入Excel文件，自动识别课程信息

4. **增强数据处理能力**
   - 支持百分制和五等级制成绩
   - 改进了数据验证和错误处理
   - 添加了详细的日志记录，便于调试和错误追踪

5. **优化打包流程**
   - 改进了PyInstaller打包脚本
   - 添加了一键打包功能
   - 确保打包后的程序能够正确处理历史记录和数据目录

6. **完善文档**
   - 添加了详细的用户指南
   - 添加了开发者文档
   - 提供了示例Excel文件

### 技术改进

1. **代码质量**
   - 添加了详细的文档字符串
   - 统一了命名规范
   - 添加了异常处理和日志记录

2. **性能优化**
   - 优化了数据加载和处理逻辑
   - 减少了不必要的计算和内存使用

3. **安全性**
   - 改进了文件路径处理，防止路径注入
   - 添加了输入验证，防止无效数据导致程序崩溃

### 已知问题

1. 历史记录功能需要程序有权限在其所在目录创建文件，如果权限不足，将使用临时目录

### 未来计划

1. 添加自动更新功能
2. 添加更多的成绩导入方式
3. 添加成绩分析和统计功能 